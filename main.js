!function(){"use strict";function e(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var t=class{constructor(e,t){var s,i,r;s=this,r=()=>this._inputList.some((e=>!e.validity.valid)),(i=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(i="_hasInvalidInput"))in s?Object.defineProperty(s,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[i]=r,this._inputSelector=e.inputSelector,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._form=t,this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._buttonElement=this._form.querySelector(this._submitButtonSelector)}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)}))}_showInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}};class s{constructor(e,t){let{items:s,renderer:i}=e;this._renderedItems=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){const t=this._renderer(e);this._container.append(t)}prepenedItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>{this.addItem(e)}))}}var i=class{constructor(e){this._popupElement=document.querySelector(`.${e}`),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&this.close()}))}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscClose)}},r=class extends i{constructor(e,t,s){super(e),this._handleFormSubmit=s,this._popupForm=this._popupElement.querySelector(".form"),this._submitButton=this._popupForm.querySelector(".form__button"),this._submitButtonText=t,this._popupInputs=this._popupForm.querySelectorAll(".form__input")}_getInputValues(){const e={};return this._popupInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)}))}close(){this._popupForm.reset(),super.close()}showLoading(){this._submitButton.textContent="Saving..."}hideLoading(){this._submitButton.textContent=this._submitButtonText}};const n={inputSelector:".form__input",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled"},o=document.querySelector(".popup_type_edit-profile").querySelector(".form"),a=document.querySelector(".popup_type_add-card").querySelector(".form"),l=document.querySelector(".popup_type_edit-avatar").querySelector(".form"),h=document.querySelector(".profile__button-edit"),c=document.querySelector(".profile__button-add"),d=document.querySelector(".profile__change-avatar-button"),u=document.querySelector(".form__input_content_name"),_=document.querySelector(".form__input_content_job"),p=document.querySelector("#card").content;let m,v;const b=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(e.statusText)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}editUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"f3a40ce9-1f69-4ecd-ac6f-bd6bc99d92d1","Content-Type":"application/json"}}),f=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._name=document.querySelector(t),this._about=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._name.textContent=t,this._about.textContent=s}setAvatar(e){this._avatar.src=e.avatar}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__avatar-img"}),y=(t,s)=>{const i=new class{constructor(t,s,i,r){let{handleCardClick:n,handleDeleteCard:o,handleLikeIcon:a}=i;e(this,"removeCard",(()=>{this._element.remove(),this._element=null})),e(this,"_setEventListeners",(()=>{this._imageElement.addEventListener("click",(()=>this._handleCardClick(this._element))),this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon(this._id)})),this._trashButton.addEventListener("click",(()=>{this._handleDeleteCard(this._id)}))})),this._title=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._cardSelector=s,this._handleCardClick=n,this._handleDeleteCard=o,this._handleLikeIcon=a,this._userId=r,this._ownerId=t.owner._id}isLiked(){return this._likes.some((e=>e._id===this._userId))}setLikes(e){this._likes=e,this._renderLikes()}_addLike(){this._likeButton.classList.add("card__button-like_liked")}_removeLike(){this._likeButton.classList.remove("card__button-like_liked")}_renderLikes(){this._likesCount.textContent=this._likes.length,this.isLiked()?this._addLike():this._removeLike()}generateCard(){return this._element=this._cardSelector.querySelector(".card").cloneNode(!0),this._likeButton=this._element.querySelector(".card__button-like"),this._imageElement=this._element.querySelector(".card__image"),this._trashButton=this._element.querySelector(".card__button-trash"),this._likesCount=this._element.querySelector(".card__likes-count"),this._cardTitle=this._element.querySelector(".card__title"),this._imageElement.src=this._link,this._imageElement.alt=this._title,this._cardTitle.textContent=this._title,this._likesCount.textContent=this._likes.length,this._setEventListeners(),this._ownerId!==this._userId&&(this._trashButton.style.display="none"),this._renderLikes(),this.isLiked()&&this._addLike(),this._element}}(t,p,{handleCardClick:()=>{S.open(t.name,t.link)},handleDeleteCard:e=>{g.open(),g.setAction((()=>{g.showLoading(),b.deleteCard(e).then((()=>{i.removeCard(),g.close()})).catch((e=>{console.log(e)})).finally((()=>{g.hideLoading()}))}))},handleLikeIcon:e=>{i.isLiked()?b.dislikeCard(e).then((e=>{i.setLikes(e.likes)})).catch((e=>{console.log(e)})):b.likeCard(e).then((e=>{i.setLikes(e.likes)})).catch((e=>{console.log(e)}))}},s);return i.generateCard()};Promise.all([b.getInitialCards(),b.getUserInfo()]).then((e=>{let[t,i]=e;v=i._id,f.setUserInfo({name:i.name,about:i.about}),f.setAvatar({avatar:i.avatar}),m=new s({items:t,renderer:e=>y(e,v)},".gallery"),m.renderItems()})).catch((e=>{console.log(e)}));const k=new r("popup_type_add-card","Save",(e=>(k.showLoading(),b.addCard(e).then((e=>{const t=y(e,v);m.prepenedItem(t),I.toggleButtonState(),k.close()})).catch((e=>{console.log(e)})).finally((()=>{k.hideLoading()})))));k.setEventListeners();const L=new r("popup_type_edit-avatar","Save",(e=>(L.showLoading(),b.editUserAvatar(e.link).then((()=>{f.setAvatar({avatar:e.link}),L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.hideLoading()})))));L.setEventListeners();const E=new r("popup_type_edit-profile","Save",(e=>{E.showLoading(),b.editUserInfo(e).then((e=>{f.setUserInfo(e),E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.hideLoading()}))}));E.setEventListeners();const S=new class extends i{constructor(e){super(e),this.popUpDescription=this._popupElement.querySelector(".popup__description"),this._image=this._popupElement.querySelector(".popup__image")}open(e,t){this.popUpDescription.textContent=e,this._image.src=t,this._image.alt=e,super.open()}}("popup_type_card");S.setEventListeners();const g=new class extends i{constructor(e){super(e),this._popupForm=this._popupElement.querySelector(".form"),this._submitButton=this._popupForm.querySelector(".form__button")}showLoading(){this._submitButton.textContent="Removing..."}hideLoading(){this._submitButton.textContent="Yes"}setAction(e){this._submitHandler=e}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}}("popup_type_delete-card-form");g.setEventListeners(),h.addEventListener("click",(()=>{const e=f.getUserInfo();var t,s;t=e.name,s=e.about,u.value=t,_.value=s,E.open(),C.resetValidation()})),c.addEventListener("click",(()=>{k.open(),I.resetValidation(),I.toggleButtonState()})),d.addEventListener("click",(()=>{L.open(),q.resetValidation(),q.toggleButtonState()}));const C=new t(n,o);C.enableValidation();const I=new t(n,a);I.enableValidation();const q=new t(n,l);q.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MUosbUJBRXRCLE1BQU1rSyxFQUErQixJQUFJQyxFQUN2Q3JILEVBQ0FHLEdBRUZpSCxFQUE2QmxLLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3Jtcy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTaG93IGVycm9yXHJcbiAgICogQHBhcmFtIHtvYmplY3R9IGlucHV0RWxlbWVudFxyXG4gICAqL1xyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogaGlkZSBlcnJvclxyXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBpbnB1dEVsZW1lbnRcclxuICAgKi9cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBzaG93IG9yIGhpZGUgZXJyb3JcclxuICAgKiBAcGFyYW0ge29iamVjdH0gaW5wdXRFbGVtZW50XHJcbiAgICovXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogY2hlY2tpbmcgYWxsIGZpZWxkcyBmb3IgdmFsaWRpdHlcclxuICAgKiBAcmV0dXJucyBib29sZWFuXHJcbiAgICovXHJcbiAgX2hhc0ludmFsaWRJbnB1dCA9ICgpID0+IHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICogdG9vZ2xlIGJ1dHRvbiBzdGF0ZVxyXG4gICAqL1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHNldCBhbGwgbGlzdGVuZXJzIG9uIHRoZSBjYXJkXHJcbiAgICovXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogc3RhcnQgdmFsaWRhdGlvblxyXG4gICAqL1xyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcblxyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoY2FyZCk7XHJcbiAgfVxyXG4gIHByZXBlbmVkSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuYWRkSXRlbShpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7cG9wdXBTZWxlY3Rvcn1gKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHN1Ym1pdEJ1dHRvblRleHQsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSBzdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgdGhpcy5fcG9wdXBJbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcblxyXG4gICAgdGhpcy5fcG9wdXBJbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0VmFsdWVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzaG93TG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgfVxyXG5cclxuICBoaWRlTG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJjb25zdCBjb25maWdDbGFzc2VzID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG59O1xyXG4vL1dyYXBwZXJzXHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIpO1xyXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuXHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1FbGVtZW50ID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuXHJcbmNvbnN0IGVkaXRBdmF0YXJDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdC1hdmF0YXJcIik7XHJcbmNvbnN0IGVkaXRBdmF0YXJFbGVtZW50ID0gZWRpdEF2YXRhckNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcblxyXG4vL0J1dHRvbnNcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uLWVkaXRcIik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uLWFkZFwiKTtcclxuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fY2hhbmdlLWF2YXRhci1idXR0b25cIlxyXG4pO1xyXG5cclxuLy9JbnB1dHNcclxuY29uc3QgbmFtZUVkaXRQcm9maWxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLmZvcm1fX2lucHV0X2NvbnRlbnRfbmFtZVwiXHJcbik7XHJcbmNvbnN0IGpvYkVkaXRQcm9maWxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X2NvbnRlbnRfam9iXCIpO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkXCIpLmNvbnRlbnQ7XHJcblxyXG5leHBvcnQge1xyXG4gIGNvbmZpZ0NsYXNzZXMsXHJcbiAgZWRpdFByb2ZpbGVNb2RhbCxcclxuICBlZGl0Rm9ybUVsZW1lbnQsXHJcbiAgYWRkQ2FyZE1vZGFsLFxyXG4gIGFkZENhcmRGb3JtRWxlbWVudCxcclxuICBlZGl0QXZhdGFyQ2FyZE1vZGFsLFxyXG4gIGVkaXRBdmF0YXJFbGVtZW50LFxyXG4gIGVkaXRQcm9maWxlTW9kYWxCdXR0b24sXHJcbiAgYWRkQ2FyZE1vZGFsQnV0dG9uLFxyXG4gIGVkaXRBdmF0YXJCdXR0b24sXHJcbiAgbmFtZUVkaXRQcm9maWxlSW5wdXQsXHJcbiAgam9iRWRpdFByb2ZpbGVJbnB1dCxcclxuICBjYXJkVGVtcGxhdGUsXHJcbn07XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7IC8vIGFkZCBpbXBvcnQgb2YgdGhlIG1haW4gc3R5bGVzaGVldHMgZmlsZVxyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybXMuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgY29uZmlnQ2xhc3NlcyxcclxuICBlZGl0Rm9ybUVsZW1lbnQsXHJcbiAgYWRkQ2FyZEZvcm1FbGVtZW50LFxyXG4gIGVkaXRBdmF0YXJFbGVtZW50LFxyXG4gIGVkaXRQcm9maWxlTW9kYWxCdXR0b24sXHJcbiAgYWRkQ2FyZE1vZGFsQnV0dG9uLFxyXG4gIGVkaXRBdmF0YXJCdXR0b24sXHJcbiAgbmFtZUVkaXRQcm9maWxlSW5wdXQsXHJcbiAgam9iRWRpdFByb2ZpbGVJbnB1dCxcclxuICBjYXJkVGVtcGxhdGUsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xyXG5cclxubGV0IGNhcmRzO1xyXG5sZXQgdXNlcklkO1xyXG5cclxuY29uc3QgZmlsbEVkaXRQcm9maWxlRm9ybSA9IChuYW1lLCBhYm91dCkgPT4ge1xyXG4gIG5hbWVFZGl0UHJvZmlsZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICBqb2JFZGl0UHJvZmlsZUlucHV0LnZhbHVlID0gYWJvdXQ7XHJcbn07XHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUFQSS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJmM2E0MGNlOS0xZjY5LTRlY2QtYWM2Zi1iZDZiYzk5ZDkyZDFcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEZpbGwgZGF0YSBpbiBlZGl0UHJvZmlsZU1vY2t1cFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gam9iXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdmF0YXJcclxuICovXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIsXHJcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2F2YXRhci1pbWdcIixcclxufSk7XHJcbi8qKlxyXG4gKiBHZW5lcmF0ZSBuZXcgY2FyZFxyXG4gKiBAcGFyYW0ge09iamVjdH0gY2FyZE9iamVjdFxyXG4gKiBAcmV0dXJucyBPYmplY3RcclxuICovXHJcbmNvbnN0IGNyZWF0ZUNhcmQgPSAoY2FyZE9iamVjdCwgdXNlcklkKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZE9iamVjdCxcclxuICAgIGNhcmRUZW1wbGF0ZSxcclxuICAgIHtcclxuICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XHJcbiAgICAgICAgaW1hZ2VNb2RhbC5vcGVuKGNhcmRPYmplY3QubmFtZSwgY2FyZE9iamVjdC5saW5rKTtcclxuICAgICAgfSxcclxuICAgICAgaGFuZGxlRGVsZXRlQ2FyZDogKGlkKSA9PiB7XHJcbiAgICAgICAgY29uZmlybU1vZGFsLm9wZW4oKTtcclxuICAgICAgICBjb25maXJtTW9kYWwuc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICAgIGNvbmZpcm1Nb2RhbC5zaG93TG9hZGluZygpO1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5kZWxldGVDYXJkKGlkKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XHJcbiAgICAgICAgICAgICAgY29uZmlybU1vZGFsLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5oaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuICAgICAgaGFuZGxlTGlrZUljb246IChpZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlzQWxyZWFkeUxpa2VkID0gY2FyZC5pc0xpa2VkKCk7XHJcbiAgICAgICAgaWYgKGlzQWxyZWFkeUxpa2VkKSB7XHJcbiAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgLmRpc2xpa2VDYXJkKGlkKVxyXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgLmxpa2VDYXJkKGlkKVxyXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICB1c2VySWRcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG59O1xyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKVxyXG4gIC50aGVuKChbaXRlbXMsIHVzZXJEYXRhXSkgPT4ge1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiB1c2VyRGF0YS5uYW1lLCBhYm91dDogdXNlckRhdGEuYWJvdXQgfSk7XHJcbiAgICB1c2VySW5mby5zZXRBdmF0YXIoeyBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhciB9KTtcclxuICAgIGNhcmRzID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBpdGVtczogaXRlbXMsXHJcbiAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSwgdXNlcklkKTtcclxuICAgICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBcIi5nYWxsZXJ5XCJcclxuICAgICk7XHJcbiAgICBjYXJkcy5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5jb25zdCBhZGROZXdDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcInBvcHVwX3R5cGVfYWRkLWNhcmRcIixcclxuICBcIlNhdmVcIixcclxuICAoZGF0YSkgPT4ge1xyXG4gICAgYWRkTmV3Q2FyZE1vZGFsLnNob3dMb2FkaW5nKCk7XHJcbiAgICByZXR1cm4gYXBpXHJcbiAgICAgIC5hZGRDYXJkKGRhdGEpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQocmVzLCB1c2VySWQpO1xyXG4gICAgICAgIGNhcmRzLnByZXBlbmVkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICAgICAgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgYWRkTmV3Q2FyZE1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGFkZE5ld0NhcmRNb2RhbC5oaWRlTG9hZGluZygpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbik7XHJcbmFkZE5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCJwb3B1cF90eXBlX2VkaXQtYXZhdGFyXCIsXHJcbiAgXCJTYXZlXCIsXHJcbiAgKGRhdGEpID0+IHtcclxuICAgIGVkaXRBdmF0YXJNb2RhbC5zaG93TG9hZGluZygpO1xyXG4gICAgcmV0dXJuIGFwaVxyXG4gICAgICAuZWRpdFVzZXJBdmF0YXIoZGF0YS5saW5rKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0QXZhdGFyKHsgYXZhdGFyOiBkYXRhLmxpbmsgfSk7XHJcbiAgICAgICAgZWRpdEF2YXRhck1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGVkaXRBdmF0YXJNb2RhbC5oaWRlTG9hZGluZygpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbik7XHJcbmVkaXRBdmF0YXJNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCJwb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiLFxyXG4gIFwiU2F2ZVwiLFxyXG4gIChkYXRhKSA9PiB7XHJcbiAgICBlZGl0TW9kYWwuc2hvd0xvYWRpbmcoKTtcclxuICAgIGFwaVxyXG4gICAgICAuZWRpdFVzZXJJbmZvKGRhdGEpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgICAgIGVkaXRNb2RhbC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBlZGl0TW9kYWwuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4pO1xyXG5lZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCJwb3B1cF90eXBlX2NhcmRcIik7XHJcbmltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3QgY29uZmlybU1vZGFsID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcInBvcHVwX3R5cGVfZGVsZXRlLWNhcmQtZm9ybVwiKTtcclxuY29uZmlybU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5lZGl0UHJvZmlsZU1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgZGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZmlsbEVkaXRQcm9maWxlRm9ybShkYXRhLm5hbWUsIGRhdGEuYWJvdXQpO1xyXG4gIGVkaXRNb2RhbC5vcGVuKCk7XHJcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmFkZENhcmRNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZE5ld0NhcmRNb2RhbC5vcGVuKCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZENhcmRGb3JtVmFsaWRhdGlvbi50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG59KTtcclxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRBdmF0YXJNb2RhbC5vcGVuKCk7XHJcbiAgZWRpdEF2YXRhckNhcmRGb3JtVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcclxuICBlZGl0QXZhdGFyQ2FyZEZvcm1WYWxpZGF0aW9uLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbn0pO1xyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVZhbGlkYXRpb24tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGNvbmZpZ0NsYXNzZXMsXHJcbiAgZWRpdEZvcm1FbGVtZW50XHJcbik7XHJcbmVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWdDbGFzc2VzLFxyXG4gIGFkZENhcmRGb3JtRWxlbWVudFxyXG4pO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhckNhcmRGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGNvbmZpZ0NsYXNzZXMsXHJcbiAgZWRpdEF2YXRhckVsZW1lbnRcclxuKTtcclxuZWRpdEF2YXRhckNhcmRGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIHJldHVybiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBnZXQgaW5mbyBhYm91dCB1c2VyIGZyb20gc2VydmVyXHJcbiAgICogQHJldHVybnMgT2JqZWN0XHJcbiAgICovXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcbiAgZWRpdFVzZXJJbmZvKG5ld1VzZXJJbmZvKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShuZXdVc2VySW5mbyksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZChuZXdDYXJkSW5mbykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShuZXdDYXJkSW5mbyksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG4gIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcbn1cclxuIiwiY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0LnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9hYm91dC50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gIH1cclxuICBzZXRBdmF0YXIoYXZhdGFyTGluaykge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhckxpbmsuYXZhdGFyO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XHJcbiIsImNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIHsgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDYXJkLCBoYW5kbGVMaWtlSWNvbiB9LFxyXG4gICAgdXNlcklkXHJcbiAgKSB7XHJcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbiA9IGhhbmRsZUxpa2VJY29uO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcmVtb3ZlIGNhcmRcclxuICAgKi9cclxuICByZW1vdmVDYXJkID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIC8vIGNoZWNrIGl0J3MgbGlrZSBvciBub3RcclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKHBlcnNvbikgPT4gcGVyc29uLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcclxuICB9XHJcblxyXG4gIC8vIHNldCBhbW91bnQgb2YgbGlrZXMgYW5kIHJlbmRlciBpdFxyXG4gIHNldExpa2VzKGxpa2VzKSB7XHJcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICB9XHJcblxyXG4gIC8vIGZpbGwgbGlrZSBpbWFnZVxyXG4gIF9hZGRMaWtlKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fYnV0dG9uLWxpa2VfbGlrZWRcIik7XHJcbiAgfVxyXG5cclxuICAvLyBjaGFuZ2Ugb24gbGlrZSBpbWFnZVxyXG4gIF9yZW1vdmVMaWtlKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fYnV0dG9uLWxpa2VfbGlrZWRcIik7XHJcbiAgfVxyXG5cclxuICAvLyByZW5kZXIgaW5mb3JtYXRpb24gYWJvdXQgbGlrZVxyXG4gIF9yZW5kZXJMaWtlcygpIHtcclxuICAgIHRoaXMuX2xpa2VzQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcclxuICAgICAgdGhpcy5fYWRkTGlrZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fcmVtb3ZlTGlrZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogc2V0IGFsbCBsaXN0ZW5lcnMgb24gdGhlIGNhcmRcclxuICAgKi9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9lbGVtZW50KVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUljb24odGhpcy5faWQpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl90cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMuX2lkKTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIC8qKlxyXG4gICAqIG5ldyBlbGVtZW50IHdpdGggY2FyZCBieSB0ZW1wbGF0ZVxyXG4gICAqIEByZXR1cm5zIG9iamVjdFxyXG4gICAqL1xyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9jYXJkU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uLWxpa2VcIik7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl90cmFzaEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b24tdHJhc2hcIik7XHJcbiAgICB0aGlzLl9saWtlc0NvdW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VzLWNvdW50XCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG5cclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XHJcbiAgICB0aGlzLl9saWtlc0NvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgIHRoaXMuX3RyYXNoQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XHJcbiAgICAgIHRoaXMuX2FkZExpa2UoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLnBvcFVwRGVzY3JpcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucG9wdXBfX2Rlc2NyaXB0aW9uXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuICB9XHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICB0aGlzLnBvcFVwRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgc2hvd0xvYWRpbmcoKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlJlbW92aW5nLi4uXCI7XHJcbiAgfVxyXG5cclxuICBoaWRlTG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XHJcbiAgfVxyXG4gIHNldEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBhY3Rpb247XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcigpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoU3VibWl0O1xyXG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dExpc3QiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2Zvcm0iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2J1dHRvbkVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicmVzZXRWYWxpZGF0aW9uIiwiZm9yRWFjaCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbmFibGVWYWxpZGF0aW9uIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJlZEl0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImRvY3VtZW50IiwiYWRkSXRlbSIsIml0ZW0iLCJjYXJkIiwiYXBwZW5kIiwicHJlcGVuZWRJdGVtIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJQb3B1cCIsInN1Ym1pdEJ1dHRvblRleHQiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfc3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfcG9wdXBJbnB1dHMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsIm5hbWUiLCJ2YWx1ZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0Iiwic2hvd0xvYWRpbmciLCJoaWRlTG9hZGluZyIsImNvbmZpZ0NsYXNzZXMiLCJlZGl0Rm9ybUVsZW1lbnQiLCJhZGRDYXJkRm9ybUVsZW1lbnQiLCJlZGl0QXZhdGFyRWxlbWVudCIsImVkaXRQcm9maWxlTW9kYWxCdXR0b24iLCJhZGRDYXJkTW9kYWxCdXR0b24iLCJlZGl0QXZhdGFyQnV0dG9uIiwibmFtZUVkaXRQcm9maWxlSW5wdXQiLCJqb2JFZGl0UHJvZmlsZUlucHV0IiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImNhcmRzIiwidXNlcklkIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0SW5pdGlhbENhcmRzIiwiZWRpdFVzZXJJbmZvIiwibmV3VXNlckluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJuZXdDYXJkSW5mbyIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwiZWRpdFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWUiLCJfYWJvdXQiLCJfYXZhdGFyIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsInNldEF2YXRhciIsImF2YXRhckxpbmsiLCJzcmMiLCJjcmVhdGVDYXJkIiwiY2FyZE9iamVjdCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUljb24iLCJfZWxlbWVudCIsIl9pbWFnZUVsZW1lbnQiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2xpa2VCdXR0b24iLCJfaGFuZGxlTGlrZUljb24iLCJfaWQiLCJfdHJhc2hCdXR0b24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl90aXRsZSIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRTZWxlY3RvciIsIl91c2VySWQiLCJfb3duZXJJZCIsIm93bmVyIiwiaXNMaWtlZCIsInBlcnNvbiIsInNldExpa2VzIiwiX3JlbmRlckxpa2VzIiwiX2FkZExpa2UiLCJfcmVtb3ZlTGlrZSIsIl9saWtlc0NvdW50IiwibGVuZ3RoIiwiZ2VuZXJhdGVDYXJkIiwiY2xvbmVOb2RlIiwiX2NhcmRUaXRsZSIsImFsdCIsInN0eWxlIiwiZGlzcGxheSIsImltYWdlTW9kYWwiLCJjb25maXJtTW9kYWwiLCJzZXRBY3Rpb24iLCJyZW1vdmVDYXJkIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsImFsbCIsInVzZXJEYXRhIiwiYWRkTmV3Q2FyZE1vZGFsIiwiUG9wdXBXaXRoRm9ybSIsImNhcmRFbGVtZW50IiwiYWRkQ2FyZEZvcm1WYWxpZGF0aW9uIiwiZWRpdEF2YXRhck1vZGFsIiwiZWRpdE1vZGFsIiwicG9wVXBEZXNjcmlwdGlvbiIsIl9pbWFnZSIsImFjdGlvbiIsIl9zdWJtaXRIYW5kbGVyIiwiZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiZWRpdEF2YXRhckNhcmRGb3JtVmFsaWRhdGlvbiIsIkZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9